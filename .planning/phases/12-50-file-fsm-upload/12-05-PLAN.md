---
phase: 12-50-file-fsm-upload
plan: 05
type: execute
wave: 5
depends_on: ["12-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "check_stability.py exit 0 at T+24h"
    - "Same 5 TUI queries produce results with no [Unresolved file #N] (comparison to T=0)"
    - "Full SC2 bidirectional cross-verification passes: 0 missing + 0 orphans + count = 50"
    - "DB counts unchanged from T=0 baseline"
  artifacts:
    - path: ".planning/phases/12-50-file-fsm-upload/12-05-SUMMARY.md"
      provides: "T+24h gate evidence with full SC2 cross-check and TUI query comparison"
      min_lines: 80
  key_links: []
---

<objective>
T+24h temporal stability gate -- BLOCKING for Phase 13. Full bidirectional cross-verification, same 5 TUI queries, and stability check.

Purpose: This is the definitive temporal stability proof. 24 hours is enough time for any Gemini-side eventual consistency issues, silent document expirations, or store mutations to manifest. This gate is BLOCKING: if it fails, Phase 13 cannot begin.

Output: 12-05-SUMMARY.md with full gate evidence. GATE VERDICT: PASS or FAIL.
</objective>

<execution_context>
@/Users/david/.claude/get-shit-done/workflows/execute-plan.md
@/Users/david/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-50-file-fsm-upload/12-03-SUMMARY.md
@.planning/phases/12-50-file-fsm-upload/12-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: T+24h full gate verification</name>
  <files>.planning/phases/12-50-file-fsm-upload/12-05-SUMMARY.md</files>
  <action>
CRITICAL PREREQUISITE: This plan MUST be executed in a FRESH Claude Code session.
Run `/clear` before starting this plan. This is the GATE BLOCKER for Phase 13.
A fresh session has no prior state and must derive its conclusion entirely from
script output, DB queries, and API calls. The distrust posture applies to the
verifier (Claude) as much as to the system being verified.

**Step 1: Read T=0 baseline**
Read `.planning/phases/12-50-file-fsm-upload/12-03-SUMMARY.md` to get T=0 values.
Also read 12-04-SUMMARY.md for T+4h comparison.

**Step 2: check_stability.py (SC5 at T+24h)**
```bash
python scripts/check_stability.py --store objectivism-library
echo "Exit code: $?"
```
Record full output verbatim. Must be exit 0.

**Step 3: DB count queries**
```sql
SELECT COUNT(*) FROM files WHERE gemini_state='indexed';
SELECT COUNT(*) FROM files WHERE gemini_store_doc_id IS NOT NULL;
```
Record and compare to T=0.

**Step 4: store-sync dry-run**
```bash
python -m objlib store-sync --store objectivism-library
```
Record full output. Compare orphan count to T=0.

**Step 5: SC2 full bidirectional cross-verification (Q6 locked algorithm)**
Run the SAME SC2 algorithm from T=0:

Step A (DB -> Store): For each of 50 indexed files:
- Read gemini_store_doc_id from DB
- Call documents.get(name=gemini_store_doc_id)
- Confirm no 404
- Count missing

Step B (Store -> DB): Call list_store_documents()
- Count total (expected: 50)
- For each, check name matches DB gemini_store_doc_id
- Count orphans

Pass: 0 missing + 0 orphans + count = 50.

Record all 50 individual document.get() results (even if all succeed -- we need the evidence trail).

**Step 6: 5 TUI search queries (same as T=0)**
Run the SAME 5 queries from T=0 SUMMARY.md:
1. "What is the nature of concepts?"
2. "How does Objectivism define morality?"
3. "What is the role of reason in human life?"
4. "Ayn Rand's theory of rights"
5. "relationship between epistemology and ethics"

Record results verbatim. Compare to T=0 results:
- Same files cited? (ordering may differ, but file set should be similar)
- Any [Unresolved file #N] appearing? (MUST be zero)
- Citation quality: do results reference real files that match DB records?

**Step 7: Delta table**
| Metric | T=0 | T+4h | T+24h | Delta (T=0 vs T+24h) |
|--------|-----|------|-------|----------------------|
| check_stability exit code | ? | ? | ? | ? |
| Indexed count | ? | ? | ? | ? |
| Store doc count | ? | ? | ? | ? |
| Orphan count | ? | ? | ? | ? |
| SC2 missing | ? | ? | ? | ? |
| SC2 orphans | ? | ? | ? | ? |
| [Unresolved file #N] count | ? | ? | ? | ? |

**Step 8: Gate verdict**
**PASS conditions (ALL must hold):**
- check_stability.py exit 0
- Indexed count = 50 (unchanged from T=0)
- SC2: 0 missing + 0 orphans
- 0 [Unresolved file #N] in TUI queries
- All deltas from T=0 are 0

If ALL pass: **GATE: PASSED -- Phase 13 unblocked**
If ANY fail: **GATE: FAILED -- investigate and remediate before proceeding**

**Step 9: Record in SUMMARY.md**
Write 12-05-SUMMARY.md with:
- T+24h timestamp and hours elapsed since T=0
- All raw output from steps 2-6
- Delta table from step 7
- Gate verdict from step 8
- Explicit statement: "Phase 13 is {UNBLOCKED/BLOCKED}"
  </action>
  <verify>
12-05-SUMMARY.md exists with:
- Complete SC2 bidirectional cross-verification (50 individual results)
- 5 TUI query results with zero [Unresolved file #N]
- Delta table comparing T=0, T+4h, T+24h
- Explicit gate verdict (PASSED or FAILED)
  </verify>
  <done>
T+24h gate verification completed. Full SC2 bidirectional cross-check of all 50 files. Same 5 TUI queries run and compared to T=0. Gate verdict recorded with all evidence.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>T+24h temporal stability gate check completed. This is the BLOCKING gate for Phase 13.</what-built>
  <how-to-verify>
    1. Review 12-05-SUMMARY.md gate evidence
    2. Confirm SC2 bidirectional cross-verification: 0 missing, 0 orphans
    3. Confirm no [Unresolved file #N] in any TUI query result
    4. Confirm all deltas from T=0 are 0
    5. Confirm gate verdict says PASSED
    6. If PASSED: Phase 13 is unblocked, T+36h confirmation (12-06) should run ~36h after T=0
    7. If FAILED: Investigate root cause before any further phases
  </how-to-verify>
  <resume-signal>Type "gate passed" to confirm Phase 12 T+24h gate, or describe failures</resume-signal>
</task>

</tasks>

<verification>
SC1: 50/50 indexed with non-null gemini_store_doc_id (unchanged from T=0)
SC2: Full bidirectional cross-verification at T+24h: 0 missing + 0 orphans
SC5: check_stability.py exit 0 at T+24h
TUI: 0 [Unresolved file #N] across all 5 queries
Temporal: All metrics identical to T=0 baseline
</verification>

<success_criteria>
- GATE VERDICT: PASSED
- SC2 bidirectional cross-verification: 0 missing, 0 orphans, count = 50
- check_stability.py exit 0
- 0 [Unresolved file #N] in TUI queries
- All T=0 vs T+24h deltas = 0
- Phase 13 explicitly marked as unblocked
</success_criteria>

<output>
After completion, 12-05-SUMMARY.md IS the artifact for this plan (gate evidence).
</output>
