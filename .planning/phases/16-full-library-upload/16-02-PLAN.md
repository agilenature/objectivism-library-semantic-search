---
phase: 16-full-library-upload
plan: 02
type: execute
wave: 2
depends_on: ["16-01"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "check_stability.py STABLE at T+4h (no drift from T=0 baseline)"
    - "check_stability.py STABLE at T+24h (BLOCKING gate for Phase 16 completion)"
    - "check_stability.py STABLE at T+36h (confirms T+24h was not transient)"
    - "All temporal check outputs recorded verbatim in SUMMARY"
  artifacts:
    - path: ".planning/phases/16-full-library-upload/16-02-SUMMARY.md"
      provides: "Temporal stability record with all checkpoint outputs"
      contains: "STABLE"
  key_links:
    - from: "scripts/check_stability.py"
      to: "data/library.db"
      via: "7 assertions including Assertion 7 with --sample-count 20"
      pattern: "check_stability"
---

<objective>
Execute the Phase 16 temporal stability protocol: T+4h, T+24h (BLOCKING gate), and T+36h checks against the full ~1,748-file corpus.

Purpose: Confirm that the full library upload is durably stable over time -- no silent data loss, no orphan accumulation, no searchability regression. T+24h is the BLOCKING gate for Phase 16 completion. Follows the Phase 12 temporal protocol pattern exactly.

Output: Temporal stability record with all checkpoint outputs. Phase 16 gate verdict.
</objective>

<execution_context>
@/Users/david/.claude/get-shit-done/workflows/execute-plan.md
@/Users/david/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-full-library-upload/16-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: T+4h stability check</name>
  <files></files>
  <action>
MANDATORY: This task MUST be executed in a FRESH Claude Code session with /clear before starting. Do NOT execute this in the same session as plan 16-01. This is a core validity requirement -- not optional ceremony.

**Timing:** Execute approximately 4 hours after the T=0 check recorded in 16-01-SUMMARY.md.

**Steps:**

1. Read 16-01-SUMMARY.md to get the T=0 baseline values (indexed count, orphan count, assertion results).

2. Run check_stability:
```bash
python scripts/check_stability.py --store objectivism-library --sample-count 20 --verbose
```
Record FULL output verbatim.

3. Run store-sync dry-run to check for orphan drift:
```bash
python -m objlib store-sync --store objectivism-library --dry-run
```
Record FULL output verbatim. Compare orphan count to T=0 baseline.

4. Run DB state query:
```bash
python -c "
import sqlite3
conn = sqlite3.connect('data/library.db')
c = conn.cursor()
c.execute(\"SELECT gemini_state, COUNT(*) FROM files WHERE filename LIKE '%.txt' GROUP BY gemini_state\")
for row in c.fetchall(): print(row)
conn.close()
"
```

5. Compare all values to T=0 baseline from 16-01-SUMMARY.md:
   - Indexed count: must match T=0 (no drift)
   - Orphan count: must be 0 (no accumulation)
   - All 7 assertions: must pass

**Verdict:** If all deltas are zero and check_stability exits 0 --> T+4h STABLE. Otherwise, document the drift and determine root cause.
  </action>
  <verify>
1. check_stability exits 0 (STABLE)
2. Indexed count matches T=0 baseline
3. Orphan count is 0
4. All values recorded verbatim in SUMMARY for T+24h comparison
  </verify>
  <done>T+4h check STABLE with zero drift from T=0. All outputs recorded for next checkpoint comparison.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
T+24h temporal stability gate check for the full ~1,748-file library upload. This is the BLOCKING gate for Phase 16 completion.

MANDATORY: Execute in a FRESH Claude Code session with /clear before starting. Do NOT reuse any prior session.
  </what-built>
  <how-to-verify>
Execute approximately 24 hours after the T=0 check from 16-01-SUMMARY.md.

1. Run check_stability:
```bash
python scripts/check_stability.py --store objectivism-library --sample-count 20 --verbose
```

2. Run store-sync dry-run:
```bash
python -m objlib store-sync --store objectivism-library --dry-run
```

3. Run 5 diverse TUI search queries and confirm no "[Unresolved file #N]" appears:
```bash
python -m objlib tui
```
Suggested queries (cover different domains):
- "What is the nature of individual rights?"
- "Aristotle's influence on Objectivism"
- "capitalism and morality"
- "aesthetic theory art Romanticism"
- "epistemology concept formation"

Record each query and its citation titles verbatim.

4. Compare to T=0 and T+4h baselines from SUMMARY.

5. Run T+36h check approximately 12 hours after T+24h (in yet another fresh session):
```bash
python scripts/check_stability.py --store objectivism-library --sample-count 20 --verbose
```
T+36h confirms T+24h was not a transient STABLE.

**Verdict criteria:**
- check_stability exits 0 at all checkpoints
- Indexed count stable across T=0, T+4h, T+24h, T+36h
- Zero orphans at all checkpoints
- No "[Unresolved file #N]" in any TUI search result
- All deltas zero between checkpoints
  </how-to-verify>
  <resume-signal>Type "T+24h STABLE" and paste the check_stability output, or describe any failures observed.</resume-signal>
</task>

</tasks>

<verification>
1. check_stability STABLE at T+4h (delta = 0 from T=0)
2. check_stability STABLE at T+24h (BLOCKING gate)
3. check_stability STABLE at T+36h (confirms non-transient)
4. 5 TUI search queries show no "[Unresolved file #N]"
5. All outputs recorded verbatim in SUMMARY
</verification>

<success_criteria>
Phase 16 SC2: check_stability.py reports STABLE at T=0, T+4h, T+24h, T+36h.
Phase 16 SC4: [Unresolved file #N] does not appear in any TUI search result (5+ diverse queries verified at T+24h).
</success_criteria>

<output>
After completion, create `.planning/phases/16-full-library-upload/16-02-SUMMARY.md`

Record ALL temporal check outputs verbatim. Include: exact timestamps, full check_stability output, store-sync counts, DB state query results, TUI query results with citation titles.
</output>
