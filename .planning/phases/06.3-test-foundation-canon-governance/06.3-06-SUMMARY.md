---
phase: 06.3-test-foundation-canon-governance
plan: 06
subsystem: tooling
tags: [canon, skills, canon-init, workflow-detection, templates, gsd, ralph, bmad, claude-code]

# Dependency graph
requires:
  - phase: 06.3-05
    provides: "8 workflow reference files with detection signals, state reading instructions, and Canon guidance"
provides:
  - "canon-init SKILL.md: global Claude Code skill for workflow-aware Canon.json generation"
  - "Canon.json.template with 8 placeholder variables for any project type"
  - "client-interface.template.md for documenting public API boundaries"
  - "3 workflow-specific rules files (GSD, Ralph, BMAD) for Canon.json rules generation"
affects: [06.3-07, 06.3-08]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "SKILL.md as executable prompt pattern: YAML frontmatter + step-by-step instructions for Claude"
    - "Template-based generation: {{PLACEHOLDER}} variables filled by skill execution"
    - "Priority-ordered detection with ambiguity warning: existing > BMAD > GSD > Ralph > Generic"
    - "Workflow-specific rules files as curated rule libraries"

key-files:
  created:
    - "~/.claude/skills/canon-init/SKILL.md"
    - "~/.claude/skills/canon-init/templates/Canon.json.template"
    - "~/.claude/skills/canon-init/templates/client-interface.template.md"
    - "~/.claude/skills/canon-init/rules/gsd-rules.md"
    - "~/.claude/skills/canon-init/rules/ralph-rules.md"
    - "~/.claude/skills/canon-init/rules/bmad-rules.md"
  modified: []

key-decisions:
  - "Detection priority order: existing _canon_workflow > BMAD > GSD > Ralph > Generic (locked from plan, implemented exactly)"
  - "Ambiguity outputs WARNING listing all detected workflows and asks user -- does NOT silently pick one"
  - "Generic is auto-default when no workflow signals found -- proceeds without asking"
  - "8 placeholders in Canon.json template: PROJECT_TITLE, PROJECT_DESCRIPTION, BRANCH, PUBLIC_FOLDERS, EXCLUDE_FOLDERS, EXCLUDE_FILES, RULES, WORKFLOW"
  - "Rules files contain 13-15 curated prose rules each, formatted for direct insertion into Canon.json rules array"
  - "SKILL.md is a 5-step executable prompt (Detect, Read Context, Analyze Codebase, Fill Templates, Report)"

patterns-established:
  - "Skill directory structure: SKILL.md + templates/ + rules/ + workflows/"
  - "Fallback chains for title and description extraction across project ecosystems"
  - "Error handling instructions embedded in skill prompts (git failure, missing manifest, existing Canon.json)"

# Metrics
duration: 3min
completed: 2026-02-18
---

# Phase 6.3 Plan 06: canon-init Skill Implementation Summary

**canon-init Claude Code skill with 5-step workflow detection, Canon.json template generation, and client-interface.md scaffolding for GSD/Ralph/BMAD/Generic projects**

## Performance

- **Duration:** 3 min
- **Started:** 2026-02-18T20:57:27Z
- **Completed:** 2026-02-18T21:00:20Z
- **Tasks:** 2
- **Files created:** 6

## Accomplishments
- Created Canon.json.template with 8 placeholder variables modeling the real Canon.json structure from this project
- Created client-interface.template.md with public/internal module sections modeling the real docs/architecture/client-interface.md
- Created 3 workflow-specific rules files (GSD: 15 rules, Ralph: 13 rules, BMAD: 14 rules) as curated rule libraries
- Implemented SKILL.md with 5-step detection and generation process, including fallback chains, ambiguity handling, and error recovery

## Task Commits

Note: All files reside in `~/.claude/skills/` (global Claude skills directory, outside any git repository). Per-task git commits are not possible for these files. The SUMMARY.md and STATE.md updates within the project repository serve as the record of this work.

1. **Task 1: Create Canon.json template and rules files** - No commit (global skill files)
2. **Task 2: Create SKILL.md with detection algorithm** - No commit (global skill files)

## Files Created
- `~/.claude/skills/canon-init/SKILL.md` — Main skill prompt with 5-step detection and generation process
- `~/.claude/skills/canon-init/templates/Canon.json.template` — Canon.json template with 8 {{PLACEHOLDER}} variables
- `~/.claude/skills/canon-init/templates/client-interface.template.md` — Client interface documentation template
- `~/.claude/skills/canon-init/rules/gsd-rules.md` — 15 GSD-specific rules covering planning, code organization, CLI conventions, and update cadence
- `~/.claude/skills/canon-init/rules/ralph-rules.md` — 13 Ralph-specific rules covering control directory, task tracking, specifications, and update cadence
- `~/.claude/skills/canon-init/rules/bmad-rules.md` — 14 BMAD-specific rules covering control directories, project context, phase model, and update cadence

## Decisions Made
- Detection priority implemented exactly as locked: existing `_canon_workflow` > BMAD > GSD > Ralph > Generic
- Ambiguity handling: outputs WARNING with all detected workflows and signals, asks user to choose
- Generic auto-defaults without asking when no workflow signals found
- Canon.json template modeled on real project Canon.json (from objectivism-library-semantic-search) for proven structure
- client-interface.template.md modeled on real project docs/architecture/client-interface.md
- Rules files use numbered prose strings for direct JSON array insertion
- SKILL.md includes error handling for: git not available, no manifest, existing Canon.json, no docs directory, empty source directory, read permission errors

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] No git commits possible for global skill files**
- **Found during:** Task 1 (attempted commit step)
- **Issue:** `~/.claude/skills/` is not inside any git repository, so per-task commits are not possible
- **Fix:** Documented as known constraint (same as plan 05); SUMMARY.md and STATE.md updates serve as the record
- **Files modified:** None (constraint accepted)
- **Verification:** All 6 files confirmed present via `find` and `ls`

---

**Total deviations:** 1 noted (same git commit constraint as plan 05)
**Impact on plan:** No functional impact. All 6 files created successfully.

## Issues Encountered
None beyond the expected constraint of global skill files being outside git.

## User Setup Required
None -- no external service configuration required. The canon-init skill is immediately available via Claude Code's skill discovery.

## Next Phase Readiness
- canon-init skill complete and ready for use
- Full directory structure: SKILL.md + templates/ (2 files) + rules/ (3 files) + workflows/ (4 files from plan 05) = 10 files total
- Plan 07 (canon-update skill) can proceed -- it follows the same pattern with audit-focused SKILL.md
- Plan 08 (apply to project) can use canon-init to regenerate Canon.json for this project

## Self-Check: PASSED

All 10 canon-init skill files confirmed present at their target paths. SUMMARY.md created.

---
*Phase: 06.3-test-foundation-canon-governance*
*Completed: 2026-02-18*
