---
phase: 06.3-test-foundation-canon-governance
plan: 05
subsystem: tooling
tags: [canon, skills, workflow-detection, gsd, ralph, bmad, global-skills]

# Dependency graph
requires:
  - phase: none
    provides: standalone research wave
provides:
  - "8 workflow reference files for canon-init and canon-update skills"
  - "Detection signals for GSD, Ralph, BMAD, and Generic workflows"
  - "Project state reading instructions for each workflow"
  - "Layer 1 audit checklists for canon-update"
affects: [06.3-06, 06.3-07, 06.3-08]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Workflow detection via control file presence"
    - "canon-init: detection + state reading + setup guidance"
    - "canon-update: detection + state reading + audit checklist"

key-files:
  created:
    - "~/.claude/skills/canon-init/workflows/gsd.md"
    - "~/.claude/skills/canon-init/workflows/ralph.md"
    - "~/.claude/skills/canon-init/workflows/bmad.md"
    - "~/.claude/skills/canon-init/workflows/generic.md"
    - "~/.claude/skills/canon-update/workflows/gsd.md"
    - "~/.claude/skills/canon-update/workflows/ralph.md"
    - "~/.claude/skills/canon-update/workflows/bmad.md"
    - "~/.claude/skills/canon-update/workflows/generic.md"
  modified: []

key-decisions:
  - "Files placed in ~/.claude/skills/ (global, not project-specific) since these are reusable across all projects"
  - "Detection logic uses mutual exclusion: presence of one workflow's control files rules out the others"
  - "Ralph detection: .ralph/ + .ralph/PROMPT.md + .ralph/fix_plan.md (researched from frankbria/ralph-claude-code)"
  - "BMAD detection: _bmad/ + _bmad/core/ directory (researched from bmad-code-org/BMAD-METHOD)"
  - "Generic fallback covers pyproject.toml, package.json, Cargo.toml, go.mod, README.md"
  - "canon-update files share detection signals but replace guidance with Layer 1 Audit Checklist"

patterns-established:
  - "Workflow reference file structure: Detection Signals table + Detection Logic + Project State Reading + Guidance"
  - "Three-level confidence scoring for detection (definitive, likely, possibly)"
  - "Mutual exclusion detection pattern (check for absence of other workflows)"

# Metrics
duration: 5min
completed: 2026-02-18
---

# Phase 6.3 Plan 05: Workflow Research Summary

**8 workflow reference files for GSD, Ralph, BMAD, and Generic — with concrete detection signals, state reading instructions, and Canon guidance from direct experience and external repo research**

## Performance

- **Duration:** 5 min
- **Started:** 2026-02-18T20:48:06Z
- **Completed:** 2026-02-18T20:53:16Z
- **Tasks:** 2
- **Files created:** 8

## Accomplishments
- Researched Ralph workflow from frankbria/ralph-claude-code repository (cloned and analyzed CLAUDE.md, docs, examples, control files)
- Researched BMAD Method from bmad-code-org/BMAD-METHOD repository (cloned and analyzed docs, workflow structure, sprint-status, agents, project-context patterns)
- Created 4 canon-init workflow reference files with detection signals, detection logic, project state reading, and canon-init/canon-update guidance
- Created 4 canon-update workflow reference files with shared detection signals and Layer 1 Audit Checklists

## Task Summary

1. **Task 1: Research and create canon-init workflow files** — 4 files created at `~/.claude/skills/canon-init/workflows/`
2. **Task 2: Create canon-update workflow files** — 4 files created at `~/.claude/skills/canon-update/workflows/`

Note: Files are in `~/.claude/skills/` (global Claude skills directory, not version-controlled). No git commits possible for these files as they reside outside any git repository.

## Files Created

- `~/.claude/skills/canon-init/workflows/gsd.md` — GSD detection: .planning/STATE.md + .planning/ROADMAP.md; state from phases, decisions, progress bars
- `~/.claude/skills/canon-init/workflows/ralph.md` — Ralph detection: .ralph/ + PROMPT.md + fix_plan.md; state from checkbox completion, priority sections
- `~/.claude/skills/canon-init/workflows/bmad.md` — BMAD detection: _bmad/ + _bmad/core/; state from sprint-status.yaml, project-context.md, PRD.md, architecture.md
- `~/.claude/skills/canon-init/workflows/generic.md` — Fallback: pyproject.toml / package.json / Cargo.toml / go.mod / README.md
- `~/.claude/skills/canon-update/workflows/gsd.md` — GSD audit: phase progress bars, SUMMARY.md drift, STATE.md decisions
- `~/.claude/skills/canon-update/workflows/ralph.md` — Ralph audit: fix_plan.md completion, PROMPT.md constraint changes, specs/stdlib/ drift
- `~/.claude/skills/canon-update/workflows/bmad.md` — BMAD audit: sprint-status.yaml story completion, project-context.md rule changes, ADR drift
- `~/.claude/skills/canon-update/workflows/generic.md` — Generic audit: git diff, CLAUDE.md changes, version tag comparison

## Research Findings

### Ralph (frankbria/ralph-claude-code)
- **Control directory:** `.ralph/` subfolder (moved from flat structure in v0.10.0)
- **Primary control files:** PROMPT.md (goals/principles), fix_plan.md (prioritized task checklist), AGENT.md (build instructions)
- **Configuration:** `.ralphrc` at project root (PROJECT_NAME, PROJECT_TYPE, MAX_CALLS_PER_HOUR, ALLOWED_TOOLS)
- **State tracking:** fix_plan.md checkboxes (`[x]` = done, `[ ]` = remaining), organized by Priority sections
- **Additional context:** `.ralph/specs/` for detailed requirements, `.ralph/specs/stdlib/` for conventions
- **Runtime state:** `.ralph/status.json` (JSON), `.ralph/logs/` (execution logs)
- **No version tracking:** Ralph does not have built-in milestone/version tracking (use git tags)

### BMAD (bmad-code-org/BMAD-METHOD)
- **Control directory:** `_bmad/` with core/ and bmm/ (or other module) subdirectories
- **Output directory:** `_bmad-output/` for generated artifacts
- **4-phase model:** Analysis > Planning > Solutioning > Implementation
- **Key artifacts by phase:**
  - Analysis: product-brief.md, brainstorming-report.md
  - Planning: PRD.md, ux-spec.md
  - Solutioning: architecture.md (with ADRs), epic-*.md files
  - Implementation: sprint-status.yaml, story-*.md files
- **State tracking:** sprint-status.yaml with development_status map (epic/story keys to statuses: backlog, ready-for-dev, in-progress, review, done)
- **Project context:** `_bmad-output/project-context.md` — "Critical Implementation Rules" section is closest analog to Canon rules
- **IDE integration:** .claude/commands/bmad-*.md (slash commands generated by installer)
- **Module system:** Core + BMM + optional modules (Builder, Test Architect, Game Dev, Creative Intelligence)

## Decisions Made

- **Global placement:** Files in `~/.claude/skills/` not project directory — these must work for any project
- **Mutual exclusion:** Detection logic checks for absence of other workflows before confirming (e.g., if .ralph/ exists, rule out GSD)
- **Shared detection, different guidance:** canon-init and canon-update files share the same detection signals but diverge on guidance (setup vs audit)
- **Layer 1 Audit Checklist pattern:** canon-update files use a structured checklist format with Folder Drift, Rule Drift, State Synchronization, and Layer 2 Check sections

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] No git commits possible for global skill files**
- **Found during:** Task 1 (attempted to commit workflow files)
- **Issue:** `~/.claude/skills/` is not inside any git repository, so per-task commits are not possible
- **Fix:** Documented this as a known constraint; the SUMMARY.md and STATE.md updates (within the project git repo) serve as the record of this work
- **Files modified:** None (constraint accepted)
- **Verification:** Files confirmed to exist at their target paths via `test -f` checks

---

**Total deviations:** 1 noted (git commit limitation for global files)
**Impact on plan:** No functional impact. All 8 workflow files were created successfully. The limitation is purely about version control of global skill files.

## Issues Encountered
None beyond the expected constraint of global skill files being outside git.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- All 8 workflow reference files ready for Plans 06 (canon-init skill) and 07 (canon-update skill)
- Detection signals are specific enough for implementing detection algorithms
- GSD signals validated against this project's actual structure
- Ralph and BMAD signals populated from repository research, not guesses

## Self-Check: PASSED

All 8 workflow reference files confirmed present at their target paths. SUMMARY.md created.

---
*Phase: 06.3-test-foundation-canon-governance*
*Completed: 2026-02-18*
